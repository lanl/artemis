# ========================================================================================
#  (C) (or copyright) 2023-2024. Triad National Security, LLC. All rights reserved.
#
#  This program was produced under U.S. Government contract 89233218CNA000001 for Los
#  Alamos National Laboratory (LANL), which is operated by Triad National Security, LLC
#  for the U.S. Department of Energy/National Nuclear Security Administration. All rights
#  in the program are reserved by Triad National Security, LLC, and the U.S. Department
#  of Energy/National Nuclear Security Administration. The Government is granted for
#  itself and others acting on its behalf a nonexclusive, paid-up, irrevocable worldwide
#  license in this material to reproduce, prepare derivative works, distribute copies to
#  the public, perform publicly and display publicly, and to permit others to do so.
# ========================================================================================

<artemis>
problem = dust_coagulation           # name of the pgen
coordinates = cartesian	# coordinate system
unit_conversion	= ppd	# ppd (code unit: AU, Msun, year/(2*pi)
r0_length	= 10.	# AU
mstar	= 1.0		# M_sun
rho0	= 1.59577e-4	# prefactor for 3D density profile
physical_units	= cgs	# 	

<parthenon/job>
problem_id = coag   # problem ID: basename of output filenames


<parthenon/output0>
file_type = hst
dt = 0.628

<parthenon/output1>
variables = gas.prim.density,   &
            dust.prim.density
file_type = hdf5	# tab data dump
dt        = 62.8 	# time increment between outputs

<parthenon/output2>
file_type = rst
dt 	  = 628

<parthenon/time>
nlim       = -1   	# cycle limit
tlim       = 6280. 	# time limit
integrator = rk2    	# time integration algorithm
ncycle_out = 1    	# interval for stdout summary info

<parthenon/mesh>
nghost = 2
refinement = none

nx1    = 16  		# Number of zones in X1-direction
x1min  = 9.0   		# minimum value of X1
x1max  = 11.0  		# maximum value of X1
ix1_bc = outflow 	# Inner-X1 boundary condition flag
ox1_bc = outflow 	# Outer-X1 boundary condition flag

nx2    = 1       	# Number of zones in X2-direction
x2min  = 0.0     	# minimum value of X2
x2max  = 6.283185307179586       # maximum value of X2
ix2_bc = periodic   	# Inner-X2 boundary condition flag
ox2_bc = periodic  	# Outer-X2 boundary condition flag

nx3    = 1      	# Number of zones in X3-direction
x3min  = -0.5     	# minimum value of X3
x3max  =  0.5      	# maximum value of X3
ix3_bc = periodic  	# Inner-X3 boundary condition flag
ox3_bc = periodic  	# Outer-X3 boundary condition flag

<parthenon/meshblock>
nx1 = 16  		# Number of cells in each MeshBlock, X1-dir
nx2 = 1  		# Number of cells in each MeshBlock, X2-dir
nx3 = 1   		# Number of cells in each MeshBlock, X3-dir

<physics>
gas = true
dust = true
coagulation = true

<gas>
cfl = 0.9		# gas cfl number
gamma = 1.00001		# adiabatic index
iso_sound_speed = 0.05	# code unit
cv = 1e5		# code unit: 1/(gamma-1)

<dust>
cfl = 0.9		# dust cfl number
nspecies = 121		# number of dust size
size_input = logspace	# dust size distribution

scr_level = 1		# for reconstruction

surface_density_flag = false  # surface or volume density 
grain_density = 1.25	# dust internal density g/cc
min_size = 1e-5		#cm
max_size = 10.0		#cm

<dust/coagulation>
vfrag 	= 1000.0	#cm/s
coag_int = 1
coag_use_adaptiveStep 	= false
coag_mom_preserve     	= false
coag_info_out		= true

<problem>
nInit_dust = 11		# number of dust species initially
dust_to_gas = 0.01	# init dust-to-gas ratio
nstep1Coag = 10		# number of steps for one coagulation call
const_coag_omega = true # using omega at r0_length

